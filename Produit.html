<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Détail Produit</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style/Produits.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <link rel="stylesheet" href="style/theme.css">
</head>
<body>

  <header class="site-header">
    <div class="logo">FUCK THE MODE</div>
    <nav class="site-nav">
      <a href="index.html"><i class="fa-solid fa-arrow-left"></i> Retour</a>
      <div class="cart-icon-container" style="display:inline-block; position:relative; margin-left:20px; cursor:pointer;" onclick="window.location.href='panier.html'">
          <i class="fa-solid fa-basket-shopping"></i>
          <span id="cart-count">0</span>
      </div>
    </nav>
  </header>

  <main class="site-main">
    <section class="product-page">
        <div class="product-image">
            <img id="product-img" src="" alt="Image produit">
        </div>

        <div class="product-info">
            <h1 id="product-title" class="product-title">Chargement...</h1>
            <p id="product-price" class="product-price">-- $</p>
            <p id="product-desc" class="description">...</p>
            
            <div class="selectors">
                <div class="selector-group">
                    <label>Taille :</label>
                    <div class="size-options">
                        <span>S</span><span>M</span><span class="selected">L</span><span>XL</span>
                    </div>
                </div>
            </div>

            <button class="add-cart">AJOUTER AU PANIER</button>
        </div>
    </section>
    <section class="recommendations-section">
      <h2 class="section-title">Vous aimerez aussi</h2>
      
      <div class="recommendation-grid" id="recommendation-container">
          </div>
  </section>

  <footer class="site-footer">

  </main>

  <footer class="site-footer">
    <p>&copy; 2025 FUCK THE MODE.</p>
  </footer>

  <script src="js/data.js"></script>
<script src="js/cart.js"></script>
<script>
    document.addEventListener("DOMContentLoaded", () => {
        const params = new URLSearchParams(window.location.search);
        const productId = params.get('id');
        const product = productsDB[productId];
        
        // Variable pour stocker la taille choisie (L par défaut)
        let selectedSize = 'L'; 

        if (product) {
            document.getElementById('product-img').src = product.img;
            document.getElementById('product-title').innerText = product.title;
            document.getElementById('product-price').innerText = product.price;
            document.getElementById('product-desc').innerText = product.desc;

            // GESTION DU CLIC SUR LES TAILLES
            const sizeSpans = document.querySelectorAll('.size-options span');
            sizeSpans.forEach(span => {
                span.addEventListener('click', function() {
                    // 1. On enlève la classe 'selected' partout
                    sizeSpans.forEach(s => s.classList.remove('selected'));
                    // 2. On l'ajoute sur celui cliqué
                    this.classList.add('selected');
                    // 3. On enregistre la taille
                    selectedSize = this.innerText;
                });
            });

            // GESTION DU BOUTON AJOUTER
            const btn = document.querySelector('.add-cart');
            btn.onclick = function() {
                // On envoie l'ID ET la taille au panier
                addToCart(productId, selectedSize);
            };
            
            // Lancer les recommandations (si tu as gardé le code précédent)
            if (typeof generateRecommendations === "function") {
                generateRecommendations(productId);
            }

        } else {
            document.querySelector('.product-info').innerHTML = "<h1>Erreur : Produit introuvable</h1>";
        }
    });

    // Code des recommandations 
    function generateRecommendations(currentId) {
        const container = document.getElementById('recommendation-container');
        if(!container) return;
        container.innerHTML = "";
        let allIds = Object.keys(productsDB);
        let availableIds = allIds.filter(id => id !== currentId);
        for (let i = availableIds.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [availableIds[i], availableIds[j]] = [availableIds[j], availableIds[i]];
        }
        let selectedIds = availableIds.slice(0, 3);
        selectedIds.forEach(id => {
            let recProduct = productsDB[id];
            container.innerHTML += `
                <a href="produit.html?id=${id}" class="rec-card">
                    <div class="rec-img-box"><img src="${recProduct.img}" alt="${recProduct.title}"></div>
                    <div class="rec-info"><h3>${recProduct.title}</h3><p class="rec-price">${recProduct.price}</p></div>
                </a>`;
        });
    }
</script>
  <script src="js/theme.js"></script>
</body>
</html>