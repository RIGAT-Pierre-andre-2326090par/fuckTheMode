<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Paiement Sécurisé</title>
    <link rel="stylesheet" href="style/paiement.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>

    <header class="site-header">
        <div class="logo">FUCK THE MODE</div>
        <nav class="site-nav">
            <a href="panier.html"><i class="fa-solid fa-arrow-left"></i> Retour au panier</a>
        </nav>
    </header>

    <main class="checkout-container">
        <section class="cart-summary">
            <h2 class="section-title">Récapitulatif</h2>
            <div class="cart-grid" id="checkout-items"></div>
            <div class="total-line">
                <span>TOTAL À PAYER :</span>
                <span class="total-price" id="checkout-total">0.00 $</span>
            </div>
        </section>

        <hr class="separator">

        <section class="checkout-form">
            <h2 class="section-title">Paiement</h2>
            <form onsubmit="finishOrder(event)">
                <div class="form-group">
                    <label>Nom complet</label>
                    <input type="text" required>
                </div>
                <div class="form-group">
                    <label>Email</label>
                    <input type="email" required>
                </div>
                <div class="form-group">
                    <label>Carte Bancaire</label>
                    <div class="input-icon">
                        <i class="fa-solid fa-credit-card"></i>
                        <input type="text" placeholder="0000 0000 0000 0000" required>
                    </div>
                </div>
                <div class="row">
                    <div class="form-group half"><label>Expiration</label><input type="text" placeholder="MM/AA" required></div>
                    <div class="form-group half"><label>CVC</label><input type="text" placeholder="123" required></div>
                </div>
                <button type="submit" class="pay-btn">PAYER MAINTENANT</button>
            </form>
        </section>
    </main>

    <footer>&copy; 2025 FUCK THE MODE.</footer>

    <script src="js/data.js"></script>
    <script src="js/cart.js"></script>
    <script>
        const container = document.getElementById('checkout-items');
        let cart = JSON.parse(localStorage.getItem('productsInCart')) || {};
        let totalAmount = 0;

        if (Object.keys(cart).length === 0) {
            container.innerHTML = "<p>Aucun article.</p>";
            document.querySelector('.pay-btn').disabled = true;
        } else {
            Object.keys(cart).forEach(id => {
                let product = productsDB[id];
                if(product){
                    let quantity = cart[id];
                    let linePrice = getPrice(product.price) * quantity;
                    totalAmount += linePrice;

                    container.innerHTML += `
                        <div class="cart-item">
                            <div class="img-box"><img src="${product.img}" alt="${product.title}"></div>
                            <div class="item-info">
                                <h3>${product.title} (x${quantity})</h3>
                                <p class="price">${linePrice.toFixed(2)} $</p>
                            </div>
                        </div>
                    `;
                }
            });
            document.getElementById('checkout-total').innerText = totalAmount.toFixed(2) + " $";
        }

        function finishOrder(e) {
            e.preventDefault();
            alert("Paiement accepté ! Merci.");
            clearCart();
            window.location.href = "index.html";
        }
    </script>
</body>
</html>